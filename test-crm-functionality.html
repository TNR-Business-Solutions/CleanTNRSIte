<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Functionality Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center; }
        .stat-number { font-size: 24px; font-weight: bold; color: #1976d2; }
        .stat-label { font-size: 14px; color: #666; margin-top: 5px; }
        button { background: #1976d2; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #1565c0; }
        .log { background: #f5f5f5; padding: 10px; border-radius: 4px; margin: 10px 0; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ CRM Functionality Test</h1>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalClients">0</div>
                <div class="stat-label">Total Clients</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeClients">0</div>
                <div class="stat-label">Active Clients</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="newLeads">0</div>
                <div class="stat-label">New Leads</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalOrders">0</div>
                <div class="stat-label">Total Orders</div>
            </div>
        </div>

        <div>
            <button onclick="clearAllData()">üßπ Clear All Data</button>
            <button onclick="addTestLead()">‚ûï Add Test Lead</button>
            <button onclick="addTestClient()">üë§ Add Test Client</button>
            <button onclick="addTestOrder()">üì¶ Add Test Order</button>
            <button onclick="refreshStats()">üîÑ Refresh Stats</button>
        </div>

        <div class="log" id="log">
            <strong>Console Log:</strong><br>
            <div id="logContent">Waiting for actions...</div>
        </div>
    </div>

    <!-- Load CRM System -->
    <script src="crm-data.js"></script>
    
    <script>
        // Override console.log to show in our log div
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logContent = document.getElementById('logContent');
            logContent.innerHTML += args.join(' ') + '<br>';
            logContent.scrollTop = logContent.scrollHeight;
        };

        // Initialize CRM
        let crm;
        function initCRM() {
            console.log('üöÄ Initializing CRM...');
            crm = new TNRCRMData();
            console.log('‚úÖ CRM initialized');
            refreshStats();
        }

        function refreshStats() {
            if (!crm) {
                console.log('‚ùå CRM not initialized');
                return;
            }
            
            const stats = crm.getStats();
            console.log('üìä Current stats:', stats);
            
            document.getElementById('totalClients').textContent = stats.totalClients;
            document.getElementById('activeClients').textContent = stats.activeClients;
            document.getElementById('newLeads').textContent = stats.newLeads;
            document.getElementById('totalOrders').textContent = stats.totalOrders;
        }

        function clearAllData() {
            console.log('üßπ Clearing all CRM data...');
            localStorage.removeItem('tnr_crm_clients');
            localStorage.removeItem('tnr_crm_leads');
            localStorage.removeItem('tnr_crm_orders');
            localStorage.removeItem('tnr_form_submissions');
            console.log('‚úÖ All data cleared');
            
            // Reinitialize CRM
            initCRM();
        }

        function addTestLead() {
            if (!crm) {
                console.log('‚ùå CRM not initialized');
                return;
            }
            
            const testLead = {
                name: 'Test Lead ' + Date.now(),
                email: 'test' + Date.now() + '@example.com',
                phone: '555-' + Math.floor(Math.random() * 10000),
                company: 'Test Company',
                source: 'Test',
                status: 'New',
                message: 'This is a test lead'
            };
            
            console.log('‚ûï Adding test lead:', testLead);
            const newLead = crm.addLead(testLead);
            console.log('‚úÖ Lead added:', newLead);
            refreshStats();
        }

        function addTestClient() {
            if (!crm) {
                console.log('‚ùå CRM not initialized');
                return;
            }
            
            const testClient = {
                name: 'Test Client ' + Date.now(),
                email: 'client' + Date.now() + '@example.com',
                phone: '555-' + Math.floor(Math.random() * 10000),
                company: 'Test Company',
                industry: 'Technology',
                services: ['Web Design'],
                notes: 'This is a test client'
            };
            
            console.log('üë§ Adding test client:', testClient);
            const newClient = crm.addClient(testClient);
            console.log('‚úÖ Client added:', newClient);
            refreshStats();
        }

        function addTestOrder() {
            if (!crm) {
                console.log('‚ùå CRM not initialized');
                return;
            }
            
            const testOrder = {
                client: 'Test Client',
                clientEmail: 'client@example.com',
                services: 'Test Service',
                amount: Math.floor(Math.random() * 5000) + 1000,
                status: 'Pending'
            };
            
            console.log('üì¶ Adding test order:', testOrder);
            const newOrder = crm.addOrder(testOrder);
            console.log('‚úÖ Order added:', newOrder);
            refreshStats();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initCRM();
        });
    </script>
</body>
</html>
