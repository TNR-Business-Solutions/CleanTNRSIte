<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear All CRM Data</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        button { background: #d32f2f; color: white; border: none; padding: 15px 30px; border-radius: 4px; cursor: pointer; font-size: 16px; margin: 10px 0; }
        button:hover { background: #b71c1c; }
        .log { background: #f5f5f5; padding: 15px; border-radius: 4px; margin: 15px 0; font-family: monospace; font-size: 14px; }
        .success { color: #2e7d32; font-weight: bold; }
        .warning { color: #f57c00; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßπ Clear All CRM Data</h1>
        <p>This will permanently delete all clients, leads, orders, and form submissions from the CRM system.</p>
        
        <button onclick="clearAllData()">üóëÔ∏è Clear All CRM Data</button>
        <button onclick="checkCurrentData()">üîç Check Current Data</button>
        <button onclick="testCRM()">üß™ Test CRM After Clear</button>
        
        <div class="log" id="log">
            <strong>Console Log:</strong><br>
            <div id="logContent">Click "Check Current Data" to see what's currently stored...</div>
        </div>
    </div>

    <!-- Load CRM System -->
    <script src="crm-data.js"></script>
    
    <script>
        // Override console.log to show in our log div
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logContent = document.getElementById('logContent');
            logContent.innerHTML += args.join(' ') + '<br>';
            logContent.scrollTop = logContent.scrollHeight;
        };

        function checkCurrentData() {
            console.log('üîç Checking current CRM data...');
            
            const clients = localStorage.getItem('tnr_crm_clients');
            const leads = localStorage.getItem('tnr_crm_leads');
            const orders = localStorage.getItem('tnr_crm_orders');
            const formSubmissions = localStorage.getItem('tnr_form_submissions');
            
            console.log('üìä Current Data:');
            console.log('- Clients:', clients ? JSON.parse(clients).length : 0);
            console.log('- Leads:', leads ? JSON.parse(leads).length : 0);
            console.log('- Orders:', orders ? JSON.parse(orders).length : 0);
            console.log('- Form Submissions:', formSubmissions ? JSON.parse(formSubmissions).length : 0);
            
            if (clients) {
                const clientsData = JSON.parse(clients);
                console.log('üë• Client Names:', clientsData.map(c => c.name).join(', '));
            }
            
            if (leads) {
                const leadsData = JSON.parse(leads);
                console.log('üìù Lead Names:', leadsData.map(l => l.name).join(', '));
            }
        }

        function clearAllData() {
            console.log('üßπ Clearing all CRM data...');
            
            // Clear all CRM-related data
            localStorage.removeItem('tnr_crm_clients');
            localStorage.removeItem('tnr_crm_leads');
            localStorage.removeItem('tnr_crm_orders');
            localStorage.removeItem('tnr_form_submissions');
            localStorage.removeItem('tnr_crm_form_submissions');
            
            console.log('‚úÖ All CRM data cleared!');
            
            // Verify data is cleared
            console.log('üîç Verification:');
            console.log('- Clients:', localStorage.getItem('tnr_crm_clients') || 'null');
            console.log('- Leads:', localStorage.getItem('tnr_crm_leads') || 'null');
            console.log('- Orders:', localStorage.getItem('tnr_crm_orders') || 'null');
            console.log('- Form Submissions:', localStorage.getItem('tnr_form_submissions') || 'null');
            
            console.log('üéâ CRM is now completely empty!');
        }

        function testCRM() {
            console.log('üß™ Testing CRM after clear...');
            
            if (typeof window.TNRCRMData !== 'undefined') {
                const crm = new TNRCRMData();
                const stats = crm.getStats();
                
                console.log('üìä CRM Stats after clear:', stats);
                
                if (stats.totalClients === 0 && stats.totalLeads === 0 && stats.totalOrders === 0) {
                    console.log('‚úÖ CRM is working correctly - all counts are 0');
                } else {
                    console.log('‚ùå CRM still has data - something went wrong');
                }
                
                // Test adding a lead
                console.log('‚ûï Testing lead creation...');
                const testLead = {
                    name: 'Test Lead',
                    email: 'test@example.com',
                    phone: '555-1234',
                    company: 'Test Company',
                    source: 'Test',
                    status: 'New',
                    message: 'This is a test lead'
                };
                
                const newLead = crm.addLead(testLead);
                console.log('‚úÖ Lead created:', newLead);
                
                const updatedStats = crm.getStats();
                console.log('üìä Updated stats:', updatedStats);
                
                if (updatedStats.newLeads === 1) {
                    console.log('üéâ Lead count is working correctly!');
                } else {
                    console.log('‚ùå Lead count is not working properly');
                }
            } else {
                console.log('‚ùå CRM not available');
            }
        }

        // Check data on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkCurrentData();
        });
    </script>
</body>
</html>
