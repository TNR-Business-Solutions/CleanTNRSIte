class TNREmailService{constructor(){this.businessEmail="roy.turner@tnrbusinesssolutions.com",this.businessPhone="412-499-2987",this.businessAddress="418 Concord Avenue, Greensburg, PA 15601"}async sendContactFormEmail(e){try{const s={service_id:this.serviceId,template_id:this.templateId,user_id:this.publicKey,template_params:{from_name:e.name||"Unknown",from_email:e.email||"No email provided",phone:e.phone||"No phone provided",company:e.company||"No company provided",website:e.website||"No website provided",industry:e.industry||"Not specified",services:Array.isArray(e.services)?e.services.join(", "):e.services||"Not specified",message:e.message||"No message provided",to_email:"roy.turner@tnrbusinesssolutions.com",subject:`New Contact Form Submission from ${e.name||"Unknown"}`,reply_to:e.email||"roy.turner@tnrbusinesssolutions.com"}};return(await fetch(this.emailEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?{success:!0,message:"Email sent successfully"}:{success:!1,message:"Failed to send email"}}catch(e){return{success:!1,message:"Email service error: "+e.message}}}async sendEmailFallback(e){try{const s=this.formatEmailContent(e),n=`mailto:roy.turner@tnrbusinesssolutions.com?subject=${encodeURIComponent(`New Contact Form Submission from ${e.name||"Unknown"}`)}&body=${encodeURIComponent(s)}`;return window.open(n),{success:!0,message:"Email client opened"}}catch(e){return{success:!1,message:"Email fallback error: "+e.message}}}formatEmailContent(e){return`\nNew Contact Form Submission\n\nName: ${e.name||"Not provided"}\nEmail: ${e.email||"Not provided"}\nPhone: ${e.phone||"Not provided"}\nCompany: ${e.company||"Not provided"}\nWebsite: ${e.website||"Not provided"}\nIndustry: ${e.industry||"Not specified"}\n\nServices of Interest:\n${Array.isArray(e.services)?e.services.join("\n- "):e.services||"Not specified"}\n\nMessage:\n${e.message||"No message provided"}\n\n---\nThis email was sent from the TNR Business Solutions contact form.\nTime: ${(new Date).toLocaleString()}\n        `.trim()}async sendWebhookEmail(e){try{const s={to:"roy.turner@tnrbusinesssolutions.com",subject:`New Contact Form Submission from ${e.name||"Unknown"}`,content:this.formatEmailContent(e),formData:e,timestamp:(new Date).toISOString()},n="https://hooks.zapier.com/hooks/catch/YOUR_WEBHOOK_ID/";return(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?{success:!0,message:"Email sent via webhook"}:{success:!1,message:"Webhook email failed"}}catch(e){return{success:!1,message:"Webhook email error: "+e.message}}}async sendEmail(e){let s=await this.sendEmailFallback(e);return s.success?s:(s=await this.sendWebhookEmail(e),s.success?s:await this.sendEmailFallback(e))}}window.tnrEmailService=new TNREmailService;